<div class="page-container">
  <div class="page-header">
    <h1 class="page-title">Detalles Rutas</h1>
    <div class="page-actions">
      <button class="btn btn-secondary" (click)="navigateToMap()" [disabled]="!selectedRouteId()">
        Ver Mapa
      </button>
      <button class="btn btn-primary" (click)="navigateToCreate()">
        Crear Ruta
      </button>
    </div>
  </div>

  <div *ngIf="errorMessage()" class="alert alert-error">
    <span>{{ errorMessage() }}</span>
    <button class="btn btn-link btn-retry" (click)="retryLoad()">
      Reintentar
    </button>
  </div>

  <div *ngIf="loading()" class="loading-container">
    <p>Cargando rutas...</p>
  </div>

  <div *ngIf="!loading() && !errorMessage()" class="table-container">
    <table class="data-table">
      <thead>
        <tr>
          <th style="width: 50px;">Seleccionar</th>
          <th>ID</th>
          <th>Nombre</th>
          <th>Centro de Distribución</th>
          <th>Vehículo</th>
          <th>Restricciones</th>
          <th>Fecha Límite</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let route of getPaginatedRoutes()" [class.selected-row]="selectedRouteId() === route.id"
          class="selectable-row" (click)="selectRoute(route.id)">
          <td (click)="$event.stopPropagation()">
            <input type="radio" name="selectedRoute" [checked]="selectedRouteId() === route.id"
              (change)="selectRoute(route.id)" title="Seleccionar ruta">
          </td>
          <td>
            <div class="id-cell">
              <span class="id-text">{{ truncateId(route.id) }}</span>
            </div>
          </td>
          <td>{{ route.name }}</td>
          <td>
            <div class="center-info">
              <strong>{{ route.distribution_center.name }}</strong>
              <span class="center-location">
                {{ route.distribution_center.city }}, {{ route.distribution_center.country }}
              </span>
            </div>
          </td>
          <td>
            <span class="vehicle-badge">{{ route.vehicle_plate }}</span>
          </td>
          <td>{{ route.restrictions || 'Ninguna' }}</td>
          <td>{{ formatDate(route.delivery_deadline) }}</td>
        </tr>
        <tr *ngIf="routes().length === 0">
          <td colspan="7" class="no-data-cell">
            No hay rutas disponibles
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!loading() && routes().length > 0" class="pagination-controls">
    <div class="page-size-selector">
      <span>Filas por página:</span>
      <select title="Página" [value]="pageSize()" (change)="changePageSize(+$any($event.target).value)">
        <option [value]="10">10</option>
        <option [value]="25">25</option>
        <option [value]="50">50</option>
      </select>
    </div>

    <div class="page-info">
      {{ getStartIndex() }} - {{ getEndIndex() }} de {{ totalRoutes() }}
    </div>

    <div class="page-navigation">
      <button (click)="goToPage(currentPage() - 1)" [disabled]="currentPage() === 1">
        ‹
      </button>
      <button (click)="goToPage(currentPage() + 1)" [disabled]="currentPage() === getTotalPages()">
        ›
      </button>
    </div>
  </div>
</div>
